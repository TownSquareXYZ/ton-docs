# 碎片

:::warning
页面正在开发中
:::

隐藏是TON区块链中允许处理大量交易的机制。 隐藏在TON中的主要想法是，当帐户A向帐户B发出消息，而帐户C则向帐户D发出消息时，这两项操作都可以异步进行。

默认情况下，Basechain(`workchain=0`)中只有一个碎片，其碎片号为`0x80000000000000`(或`1000000000000000000000000000000000000000000000000000000000`二进制表示)。 大师级链(“工作链=-1”)总是有一张，只有一张。

## 拆分

每个仓库负责一些带有一些常见二进制前缀的子帐户。 这个前缀出现在一个64位整数呈现出来并具有以下结构：`<binary prefix>100000...` 。 例如，id为 `1011100000...` 的店铺包含所有开头为 `1011`的账户。

当交易数量在某些碎片增长时，它会分成两块碎片。 获取以下ID的新碎片：`<parent prefix>01000...`和`<parent prefix>11000... 并相应地负责从`<parent prefix>0`和`<parent prefix>1\`开始的账户。 碎片中方块的下划线从上一节加1开始。 拆分碎片后独立运行，可能有不同的下划线。

Masterchain 块包含关于其头部碎片的信息。 当区块出现在大师链头上，它可以被视为已经完成(不能回滚)。

示例：

- Masterchain 块 `seqno=34607821` 有 2 shards: `(0,40000000000000,40485798)` 和 `(0,c0000000000000000000,40485843)` (https://toncenter.com/api/v2/shards?seqno=34607821)。
- Shard `shard=400000000000` 被分割成`shard=200000000000` 和 `shard=600000000000` 和 `shard=600000000000` ，masterchain 块 `seqno=34607822` 已经有三个碎片：`(0200000000000000000,40485799)` 和 `(06000000000000000,40485799)` 。 请注意，两张新的碎片都有相同的下划界块，但不同的碎片ID(https://toncenter.com/api/v2/shards?seqno=34607822)。
- 新的碎片独立去，100个大师链块(在masterchain block `seqno=34607921`)后，一个碎片有最后一个块`(0,20000000000000,40485901)`，另一个块有`(0,6000000000000000,40485897)` (https://toncenter.com/api/v2/shards?seqno=34607921)。

## 合并

当碎片负载下来时，它们可以合并到下面：

- 两张碎片如果有共同的父级，就可以合并它们的碎片号为`<parent prefix>010...` 和 `<父级前缀110...'。 Merged shard will have shard id `<parent prefix>10...`(for example`10010...`+`10110...`=`1010...`). 合并后的第一个块将有 `seqno=max(seqno1, seqno2) + 1\` 。

示例：

- 在masterchain 块`seqno=34626306`中，五个碎片中的两个，最后一个块`(0,a0000000000000,40492030)`和`(0,e0000000000000,40492216)`并入一个块`(0,c0000000000000,40492217)` (https://toncenter.com/api/v2/shards?seqno=34626306和https://toncenter.com/api/v2/shards?seqno=34626307)。
