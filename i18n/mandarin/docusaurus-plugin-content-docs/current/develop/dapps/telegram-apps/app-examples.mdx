import Button from '@site/src/components/button'

# TMA 示例

查看下面的示例以查看如何创建您自己的 Telegram Mini App。

## 基本的 TMA 示例

<p align="center">
  <br />
    <img width="240" src="/img/docs/telegram-apps/tapps.png" alt="logo of telegram mini apps" />
      <br />
</p>

这是一个使用普通的 JavaScript, HTML 和 CSS 来实现的 Telegram Mini App(TMA)。 这个项目旨在提供一个简单的例子，说明如何创建一个简单的TMA，并在 Telegram 中启动它，而不依赖复杂的构建工具或出血式图书馆。

- 应用可通过直接链接获取：[t.me/simple_telegram_mini_app_bot/app](https://t.me/simple_telegram_mini_app_bot/app)
- 或者您可以使用机器人菜单按钮启动应用程序：[t.me/simple_telegram_mini_app_bo](https://t.me/simple_telegram_mini_app_bot)
- 部署 URL： <https://telegram-mini-apps-dev.github.io/vanilla-js-boilerplate/>

<Button href="https://t.me/simple_telegram_mini_app_bot/app" colorType={'primary'} sizeType={'sm'}>Open Demo</Button>
<Button href="https://github.com/Telegram-Mini-Apps-Dev/vanilla-js-boilerplate.git" colorType={'secondary'} sizeType={'sm'}>GitHub</Button>

### 功能

- 最小用户界面。
- 没有使用外部库或框架。
- 易于理解和修改。

### 正在开始

#### 必备条件

要运行这个示例，您需要一个启用JavaScript的现代网页浏览器。

#### 安装

1. 将这个仓库复制到您的本地机器：

```bash
git clone https://github.com/Telegram-Mini-Apps-Dev/vanilla-js-boilerplate.git
```

2. 导航到项目目录：

```bash
cd vanilla-js-boilerplate
```

在您首选的代码编辑器或 IDE 中打开 index.html 。

### 用法

1. 在您首选的代码编辑器或 IDE 中打开 index.html 。
2. 进行更改
3. 创建您自己的 GitHub 仓库，提交并推送您的更新。
4. 转到您的仓库 GitHub 页面并打开设置。 检查页面标签以及构建和部署部分。 如果选择 GitHub 动作选项，资产应该被部署到页面上，并且会有一个 'https:///<username>.github.io/vanilla-js-boilerplate/\`. 您可以复制此 URL 并使用 [BotFather](https://tg.me/BotFather) 机器人来创建您自己的 TWA。

## 现代TMA 示例

### 一. 导言

Vite（意指法语的“快速”）是一个前端构建工具和开发服务器，旨在为现代网络项目提供更快和更干净的开发经验。 我们将使用 Vite 来创建 Telegram Mini App 示例。

您可以在这里找到示例项目<https://github.com/Telegram-Mini-Apps-Dev/vite-boilerplate>或您可以通过以下指示。

### 必备条件

我们将从您的 Vite 项目的 scaffoling 开始。

使用NPM：

```bash
$npm 创建 vite@最新版本
```

用 Yarn：

```bash
$ yarn 创建 vite
```

然后跟随提示！

或者你可以简单地运行此命令来使用 TypeScript 支持来创建React 项目：

```bash
# npm 7+, 需要额外的双破折叠:
npm create vite my-react-telegram-web-app -- --template react-ts

# 或 yarn
yarn create vite my-react-telegram-web-app --template react-ts

# 这将把目录更改为最近创建的项目
cd my-react-telegram-web-app
```

### 开发Mini App

现在我们需要启动项目的开发模式，在终端中运行以下命令：

```bash
# npm
npm install
npm run dev --host

# or yarn
yarn
yarn dev --host
```

`--host` 选项允许获取 IP 地址的 URL，您可以在开发过程中用于测试目的。 重要注意：在开发模式中，我们将使用自签名的 SSL 证书 这将使我们能够通过热重新加载来测试我们的应用，仅在 Telegram 中的 web 版本[https://web. elegram.org](https://web.telegram.org/a/#6549734463)/因为其他平台 (iOS, Android, MacOS) 政策。

我们需要添加 `@vitejs/plugin-basic-ssl` 插件：

```bash npm2yarn
npm install @vitejs/plugin-basic-ssl
```

现在我们需要修改 `vite.config.ts` 。 添加导入：

```jsx
从 '@vitejs/plugin-basic-ssl'导入BasicSsl;
```

添加插件

```jsx
export default defineConfig({
   plugins: [react(), basicSsl()]
});
```

您可以使用 `ngrok` 来通过SSL 证书将本地服务器曝光到互联网。 您将能够在所有 Telegram 平台上使用热模块替换。 打开新终端窗口并运行：

```bash
# 其中5173 是来自npm/yarn dev --host
ngrok http 5173 的端口。
```

我们还将准备部署到GitHub Pages的项目：

```jsx
export default defineConfig({
   plugins: [react(), basicSsl()],
	 build: {
	   outDir: './docs'
	 },
   base: './'
});
```

我们将使用 GitHub 动作的部署脚本，这些动作将在主分支的推送上运行。 从你的项目的根目录：

```bash
# 我们将创建 GitHub 动作配置，用于部署
mkdir .github
cd 。 ithub
mkdir workflow
cd workflow
tout static.yml
```

现在将此配置添加到“static.yml”：

```yaml
# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ['master']

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets the GITHUB_TOKEN permissions to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: 'pages'
  cancel-in-progress: true

jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Setup Node
        uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'
          cache-dependency-path: './'
      - name: Install dependencies
        run: npm install
      - name: Build
        run: npm run build
      - name: Setup Pages
        uses: actions/configure-pages@v3
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v1
        with:
          # Upload dist repository
          path: './docs'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v1
```

别忘了选择 GitHub 操作选项，在设置中构建和部署——您的GitHub 仓库的页面. 现在在每个push之后，你的代码将会被部署到页面。

![屏幕截图2023-09-11 at 22.07.44.png](/img/docs/telegram-apps/modern-1.png)

现在我们将增加两个`@twa-dev/sdk`。 Telegram 透過 [link](https://core.telegram.org/bots/webapps#initializing-web-apps)发行SDK 与一个库一起工作是一种好奇的方式。 `@twa-dev/sdk`软件包允许与 SDK 一样使用 npm 软件包和 TypeScript 支持。

```bash npm2yarn
npm install @twa-dev/sdk
```

打开`/src/main.tsx`文件并添加以下内容：

```tsx
import WebApp from '@twa-dev/sdk'

WebApp.ready();

ReactDOM.createRoot...
```

`WebApp.ready()` - 是一个告知Telegram 应用程序Mini App 已准备好显示的方法。 建议在所有必要的接口元素加载后尽快将这种方法调用。 一旦此方法被调用，加载占位符将被隐藏并显示 Mini 应用程序。

然后我们将添加一些与用户的交互。 转到`src/App.tsx`，我们将以警示方式添加按钮。

```tsx
import { useState } from 'react'
import reactLogo from './assets/react.svg'
import viteLogo from '/vite.svg'
import './App.css'

import WebApp from '@twa-dev/sdk'

function App() {
  const [count, setCount] = useState(0)

  return (
    <>
      <div>
        <a href="https://vitejs.dev" target="_blank">
          <img src={viteLogo} className="logo" alt="Vite logo" />
        </a>
        <a href="https://react.dev" target="_blank">
          <img src={reactLogo} className="logo react" alt="React logo" />
        </a>
      </div>
      <h1>Vite + React</h1>
      <div className="card">
        <button onClick={() => setCount((count) => count + 1)}>
          count is {count}
        </button>
      </div>
		{/* Here we add our button with alert callback */}
      <div className="card">
        <button onClick={() => WebApp.showAlert(`Hello World! Current count is ${count}`)}>
            Show Alert
        </button>
      </div>
    </>
  )
}

export default App
```

现在我们需要创建 Telegram Bot，以便我们可以在信使应用程序中启动 Telegram Mini 应用程序。

### 为应用程序设置Bot

要连接您的 Mini 应用程序到 Telegram ，您需要创建机器人并为此设置一个 Mini 应用。 按照这些步骤设置一个新的 Telegram 機器人：

<Button href="/develop/dapps/telegram-apps/step-by-step-guide#setting-up-a-bot-for-the-app" colorType={'primary'} sizeType={'sm'}>Setup a Bot</Button>

### 提示

有了自签名的 SSL 证书，您可以质疑这类警告的问题。 Click “Advanced” button and the click `Proceed <local dev server address here>`. 没有这个步骤，您将无法在 web 版本的 Telegram 中调试

![屏幕截图2023-09-11 at 18.58.24.png](/img/docs/telegram-apps/modern-2.png)
